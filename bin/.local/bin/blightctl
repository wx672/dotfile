#!/bin/bash

# This script is supposed to be invoked via hotkeys defined in dwm
cmdchk blight dzen2 || exit 127

gdbar() {
  awk -F"," '/Current/ { print $2 }' <(blight status) | tr -d '%' |
    dzen2-gdbar -h '30' |
    dzen2 -p 1 -w '90' -x '1800' -h '40'
}

case $1 in
  get)
    blight status   
    exit
    ;;
  inc)
    blight inc 3 -s && gdbar
    exit
    ;;
  dec)
    blight dec 3 -s && gdbar
    exit
    ;;
  *)
    echo ${0##*/} 'get|inc|dec'
    exit 1
    ;;
esac
